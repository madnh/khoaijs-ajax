{"version":3,"sources":["ajax.min.js"],"names":["root","factory","define","amd","dependencies","_","jQuery","Khoai","EventEmitter","PreOptions","Task","Priority","module","Ajax","this","$","options","call","get","constants","AJAX_PRE_OPTIONS_NAME","jqXHR","requested","retry_time","_last_options","_is_retrying","_retry_timeout_id","response","error","_is_response_meaning_failed","isObject","option","_ajax_done_cb","result","apply","response_tasks","isRetryable","emitEvent","message","code","data","clone","_ajax_fail_cb","textStatus","errorThrown","hasOwnProperty","responseJSON","beautifyError","arguments","isAborted","_at_the_end","ajax_instance","_ajax_always_cb","self","isRetrying","isLastRetryTime","retry_delay","setTimeout","request","_getRequestOptions","instance","before_send_cb","last_options","extend","removeListener","addListener","values","pick","priority","PRIORITY_HIGHEST","key","beforeSend","omit","bind","settings","isRequesting","abort","isFunction","responses","isEmpty","data_tasks","request_data_result","_do_request","length","ajax","done","fail","always","_ajax_restful_shorthand_func","method","url","callback","dataType","args","toUpperCase","util","optionalArgs","Array","prototype","slice","_load_apply_content","target","apply_type","append","prepend","html","jqXHR_response_statuses","204","400","401","403","404","405","406","408","413","414","429","431","500","501","parser_error","aborted","AJAX_ABORTED","AJAX_TIMEOUT","AJAX_PARSER_ERROR","AJAX_SERVER_ERROR","AJAX_FORBIDDEN","AJAX_NOT_FOUND","inherit","Object","defineProperty","enumerable","value","auto_abort","retry","is_continue","globalOption","update","error_arguments","err_result","status","setup","concat","toArray","addData","name","isString","map","on","isSuccess","isFailed","isDone","readyState","isReady","Boolean","isResponseMeaningFailed","parseInt","clearTimeout","forEach","query","send","use","pre_options_name","custom_options","load","error_content","error_message","error_code"],"mappings":"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","file":"ajax.min.js","sourcesContent":["!function(t,e){if(\"function\"==typeof define&&define.amd){var r=[\"lodash\",\"jquery\",\"khoaijs\",\"khoaijs-event-emitter\",\"khoaijs-pre-options\",\"khoaijs-task\",\"khoaijs-priority\"];define(r,function(r,i,s,o,n,a,p){var u=e(r,i,s,o,n,a,p);return s.Ajax=u,t.Ajax=u,u})}else{var i=e(t._,t.jQuery,t.Khoai,t.Khoai.EventEmitter||t.EventEmitter,t.Khoai.PreOptions||t.PreOptions,t.Khoai.Task||t.Task,t.Khoai.Priority||t.Priority);t.Khoai.Ajax=i,t.Ajax=i}}(this,function(t,e,r,i,s,o,n){\"use strict\";function a(e){i.call(this),this.options=s.get(m.AJAX_PRE_OPTIONS_NAME),this.jqXHR=null,this.requested=0,this.retry_time=0,this._last_options=null,this._is_retrying=!1,this._retry_timeout_id=null,this.response=null,this.error=null,this._is_response_meaning_failed=!1,t.isObject(e)&&this.option(e)}function p(e){var r=o.apply(e,this.options.response_tasks);if(r.error)return this._is_response_meaning_failed=!0,this.error=r.error,void(this.isRetryable()||this.emitEvent(\"fail\",r.error.message,r.error.code));this.response=r.data,this.emitEvent(\"done\",t.clone(r.data))}function u(t,e,r){var i=a.beautifyError(arguments);this.error=i,this.isRetryable()||this.isAborted()||this.emitEvent(\"fail\",i.message,i.code)}function l(t){t._last_options=null,t._is_retrying=!1,t.emitEvent(\"always\",t.error,t.response)}function h(t,e){var r=this;if(this.isAborted())this.emitEvent(\"aborted\");else if(this.isRetryable())return this.isRetrying()&&this.emitEvent(\"retry_complete\",this.retry_time,this.isLastRetryTime(),t,e),this._is_retrying=!0,void(this.options.retry_delay?this._retry_timeout_id=setTimeout(function(){r.request()},this.options.retry_delay):this.request());l(this)}function c(e,r){var i,s=t.extend({},e.options,t.isObject(r)?r:{});if((s.hasOwnProperty(\"success\")||s.hasOwnProperty(\"done\"))&&(e.removeListener(\"success_listeners_from_options\"),e.addListener(\"done\",t.values(t.pick(s,[\"success\",\"done\"])),{priority:n.PRIORITY_HIGHEST,key:\"success_listeners_from_options\"})),(s.hasOwnProperty(\"error\")||s.hasOwnProperty(\"fail\"))&&(e.removeListener(\"error_listeners_from_options\"),e.addListener(\"fail\",t.values(t.pick(s,[\"error\",\"fail\"])),{priority:n.PRIORITY_HIGHEST,key:\"error_listeners_from_options\"})),(s.hasOwnProperty(\"complete\")||s.hasOwnProperty(\"always\"))&&(e.removeListener(\"complete_listeners_from_options\"),e.addListener(\"always\",t.values(t.pick(s,[\"complete\",\"always\"])),{priority:n.PRIORITY_HIGHEST,key:\"complete_listeners_from_options\"})),s.hasOwnProperty(\"beforeSend\")&&(i=s.beforeSend),s=t.omit(s,[\"success\",\"done\",\"error\",\"fail\",\"complete\",\"always\",\"beforeSend\"]),s.done=p.bind(e),s.fail=u.bind(e),s.always=h.bind(e),s.beforeSend=function(r,o){var n=!0;return e.option(\"auto_abort\")&&e.isRequesting()&&e.abort(),t.isFunction(i)&&!e.isRetrying()&&(n=i.apply(e,[r,o])),t.isObject(s.data)||(s.data={}),!1!==n&&(e.requested++,e.error=null,e._is_response_meaning_failed=!1,e.response=null,e.responses=null,e.isRetrying()?(e.retry_time++,e.emitEvent(\"retry\")):(e.retry_time=0,e.emitEvent(\"request\"))),n},!t.isEmpty(s.data_tasks)){var a=o.apply(t.clone(s.data),s.data_tasks);if(!a.data)return this.error=a.error,!1;s.data=a.data}return t.omit(s,[\"response_tasks\",\"data_tasks\",\"auto_abort\",\"retry\",\"retry_delay\",\"is_continue\"])}function d(r,i){var s;return(1==arguments.length||r.isRetrying())&&t.isObject(r._last_options)?s=r._last_options:(s=c(r,i),!1!==s?r._last_options=s:(r.emitEvent(\"fail\",r.error.message,r.error.code),l(r))),s&&(r.jqXHR=e.ajax(t.omit(s,[\"done\",\"fail\",\"always\"])).done(s.done).fail(s.fail).always(s.always)),r}function y(t,e,i,s,o,n){var a,p={url:i,method:(e+\"\").toUpperCase()};return a=r.util.optionalArgs(Array.prototype.slice.call(arguments,3),[\"data\",\"callback\",\"dataType\"],{data:[\"string\",\"Object\"],callback:\"Function\",dataType:\"string\"}),a.data&&(p.data=a.data),a.callback&&(p.done=a.callback),a.dataType&&(p.dataType=a.dataType),d(t,p)}function _(t,r,i){switch(r=e(r),i){case\"append\":r.append(t);break;case\"prepend\":r.prepend(t);break;default:r.html(t)}}var f,m,b={204:\"Server has received the request but there is no information to send back\",400:\"The request had bad syntax or was inherently impossible to be satisfied\",401:\"The parameter to this message gives a specification of authorization schemes which are acceptable\",403:\"The request is for something forbidden\",404:\"The server has not found anything matching the URI given\",405:\"Method not allowed\",406:\"Not acceptable\",408:\"Request timeout\",413:\"Payload too large\",414:\"URI too long\",429:\"Too many requests\",431:\"Request header fields too large\",500:\"The server encountered an unexpected condition which prevented it from fulfilling the request\",501:\"The server does not support the facility required\",parser_error:\"Parse response failed\",aborted:\"Manual abort request\"};m={AJAX_PRE_OPTIONS_NAME:\"Khoai.Ajax\",AJAX_ABORTED:\"aborted\",AJAX_TIMEOUT:\"timeout\",AJAX_PARSER_ERROR:\"parser_error\",AJAX_SERVER_ERROR:500,AJAX_FORBIDDEN:403,AJAX_NOT_FOUND:404},r.util.inherit(a,i);for(f in m)m.hasOwnProperty(f)&&Object.defineProperty(a,f,{enumerable:!0,value:m[f]});return s.define(m.AJAX_PRE_OPTIONS_NAME,{response_tasks:[],data_tasks:{},auto_abort:!0,retry:0,retry_delay:0,is_continue:!0}),a.globalOption=function(t){s.update(m.AJAX_PRE_OPTIONS_NAME,t)},a.beautifyError=function(t){var e=t[0],r=t[1],i=t[2],s={code:\"\",message:\"Ajax error\"};switch(r){case\"parsererror\":s.code=m.AJAX_PARSER_ERROR;break;case\"abort\":s.code=m.AJAX_ABORTED;break;default:s.code=e.status}return b.hasOwnProperty(s.code)?s.message=b[s.code]:s.message=i,s},a.prototype.option=function(e,i){return this.options=r.util.setup.apply(null,[this.options].concat(t.toArray(arguments))),this},a.prototype.data=function(t){return this.options.data=t,this},a.prototype.addData=function(e,r){var i;return this.options.data||(this.options.data={}),t.isObject(arguments[0])?i=t.extend({},e):(i={},arguments.length<2?i[e+\"\"]=\"true\":i[e]=r),t.isObject(this.options.data)?t.extend(this.options.data,i):t.isString(this.options.data)&&(i=t.map(i,function(t,e){return e+\"=\"+t}),this.options.data.length?this.options.data+=\"&\"+i:this.options.data=i),this},a.prototype.done=function(e){return this.on(\"done\",e),this.isSuccess()&&e.apply(this,[t.clone(this.response)]),this},a.prototype.fail=function(t){return this.on(\"fail\",t),this.isFailed()&&t.apply(this,[this.error.message,this.error.code]),this},a.prototype.always=function(t){return this.on(\"always\",t),this.isDone()&&t.apply(this,[this.error,this.response]),this},a.prototype.status=function(){return!(!t.isObject(this.jqXHR)||!this.jqXHR.hasOwnProperty(\"readyState\"))&&this.jqXHR.readyState},a.prototype.isReady=function(){var t=this.status();return!1!==t&&0===t},a.prototype.isRequesting=function(){var t=this.status();return!1!==t&&t>=1&&t<=3},a.prototype.isRetrying=function(){return Boolean(this._is_retrying)},a.prototype.isDone=function(){return!this.isRetrying()&&4===this.status()},a.prototype.isFailed=function(){return this.isDone()&&!t.isEmpty(this.error)},a.prototype.isResponseMeaningFailed=function(){return this.isFailed()&&this._is_response_meaning_failed},a.prototype.isSuccess=function(){return this.isDone()&&t.isEmpty(this.error)},a.prototype.isAborted=function(){return this.error&&this.error.code===m.AJAX_ABORTED},a.prototype.isLastRetryTime=function(){return this.isRetrying()&&this.options.retry&&this.retry_time>=parseInt(this.options.retry)},a.prototype.isRetryable=function(){if(!t.isEmpty(this.error)&&!this.isAborted()&&!this.isResponseMeaningFailed()&&this.options.retry&&this.retry_time<parseInt(this.options.retry)){return t.isFunction(this.options.is_continue)?this.options.is_continue.bind(this)(t.clone(this.error)):Boolean(this.options.is_continue)}return!1},a.prototype.request=function(t){return d(this,t)},a.prototype.abort=function(){this.isRequesting()&&this.jqXHR.abort?this.jqXHR.abort():this.isRetrying()&&(clearTimeout(this._retry_timeout_id),this.emitEvent(\"aborted\"),l(this))},[\"get\",\"post\",\"put\",\"delete\"].forEach(function(t){a.prototype[t]=function(e,r,i,s){return y.apply(null,[this,t.toUpperCase()].concat(Array.prototype.slice.call(arguments,0)))}}),[\"get\",\"post\"].forEach(function(t){a.prototype[t+\"JSON\"]=function(t,e,i){var s=r.util.optionalArgs(Array.prototype.slice.call(arguments,0,3),[\"url\",\"data\",\"callback\"],{url:\"string\",data:[\"string\",\"Object\"],callback:\"Function\"}),o={dataType:\"json\"};return s.url&&(o.url=s.url),s.data&&(o.data=s.data),s.callback&&(o.done=s.callback),this.request(o)}}),[\"get\",\"post\",\"put\",\"delete\",\"getJSON\",\"postJSON\"].forEach(function(t){a[t]=function(e,r,i,s){var o=new a;return o[t].apply(o,Array.prototype.slice.call(arguments,0)),o}}),a.prototype.query=function(t){var e={method:\"GET\"};return t&&(e.data=t),this.request(e)},a.prototype.send=function(t){var e={method:\"POST\"};return t&&(e.data=t),this.request(e)},a.use=function(t,e){return new a(s.get(t,e))},a.load=function(e,r,i){var s=new a;return t.isObject(i)||(i={}),i=t.extend({error_content:\"\",apply_type:\"replace\"},i,{url:e}),s.option(i),s.done(function(t){_(t,r,i.apply_type)}).fail(function(e,o){var n=\"\";i.error_content&&(n=t.isFunction(i.error_content)?i.error_content(s,e,o):i.error_content+\"\"),_(n,r,i.apply_type)}),s.request(),s},a});\r\n//# sourceMappingURL=ajax.min.js.map\r\n"]}